---
title: "Chamois"
author: "Franz Johann, LiangWen, Matthias Theobald"
date: "2. Dezember 2015"
output: html_document
---

```{r, echo=FALSE}
library(mgcv)
```

data exploration and visualisation

```{r}
## animal density
with(db_chamois, tapply(density, list(year, area_cod), unique))
# we have an animal density per administrative area per year  which is then 
# confirmed in the next year or changed.
```

```{r}
# Effect of NAO on winter weather
cor.test(dbr$nao_w, dbr$twinter.mean)
cor.test(dbr$nao_w, dbr$twinter.min)
cor.test(dbr$nao_w, dbr$snow_winter)

```

```{r}
## spatial distribution of horn size, comparing elevation
# horn size
m1 <- gam(horn~s(x.council, y.council), data=db_chamois)
vis.gam(m1, plot.type = "contour")

# elevation, unweighted and interpolated!
m2 <- gam(q_media~s(x.council, y.council), data=db_chamois)
vis.gam(m2, plot.type = "contour", main="Elevation", xlab="", ylab="")

# distribution of councils by admin. area
points(x.council, y.council, col=area_cod, pch=20, cex=1.5)
legend("bottomright", legend=unique(area_cod), col=unique(area_cod), pch=20)
# no data in south-east and north-west!

tapply(horn, area_cod, mean) # horn size per area
tapply(q_media, area_cod, mean) # mean elevation per area
```

It is clearly visible that horn size in area number 3 is higher because of the lower mean elevation of that area.

```{r}
# selecting all weight data which are whole numbers
tol <- 1e-12
db_chamois$int_weight <- 0

db_chamois$int_weight[sapply(db_chamois$weight, function(y) min(abs(c(y%%1, y%%1-1))) < tol)] <- 1

sum(int_weight) # whole numbers in weight
length(int_weight) - sum(int_weight) # floating point numbers

# are the integers and floating point weigths evenly distributed over the councils?

plot(tapply(int_weight, council_cod, function(y) sum(y)/length(y)), type="h", cex=1.4,
    main="weight int / all", xlab="council", ylab="")

plot(tapply(int_weight, area_cod, function(y) sum(y)/length(y)), type="h", cex=1.4,
    main="weight int / all", xlab="area", ylab="")

``


