---
title: "Chamois"
author: "Franz Johann, LiangWen, Matthias Theobald"
date: "2. Dezember 2015"
output: html_document
---

```{r, echo=FALSE}
library(mgcv)
```

data exploration and visualisation

```{r}
## animal density
with(db, tapply(density, list(year, area_cod), unique))
# we have an animal density per administrative area per year  which is then 
# confirmed in the next year or changed.
```

```{r}
# Effect of NAO on winter weather
cor.test(db$nao_w, db$twinter.mean2)
cor.test(db$nao_w, db$twinter.min2)
cor.test(db$nao_w, db$snow_winter2)

```

```{r}
## spatial distribution of horn size, comparing elevation
# horn size
m1 <- gam(horn~s(x.council, y.council), data=db)
vis.gam(m1, plot.type = "contour")

# elevation, unweighted and interpolated!
m2 <- gam(q_media~s(x.council, y.council), data=db)
vis.gam(m2, plot.type = "contour", main="Elevation", xlab="", ylab="")

# distribution of councils by admin. area
with(db, points(x.council, y.council, col=area_cod, pch=20, cex=1.5))
with(db, legend("bottomright", legend=unique(area_cod), col=unique(area_cod), pch=20))
# no data in south-east and north-west!

with(db, tapply(horn, area_cod, mean)) # horn size per area
with(db, tapply(q_media, area_cod, mean)) # mean elevation per area
```

It is clearly visible that horn size in area number 3 is higher because of the lower mean elevation of that area.

```{r}
# selecting all weight data which are whole numbers
tol <- 1e-12
db$int_weight <- 0

db$int_weight[sapply(db$weight, function(y) min(abs(c(y%%1, y%%1-1))) < tol)] <- 1

sum(db$int_weight) # whole numbers in weight
length(db$int_weight) - sum(db$int_weight) # floating point numbers

# are the integers and floating point weigths evenly distributed over the councils?

plot(with(db, tapply(int_weight, council_cod, function(y) sum(y)/length(y))), type="h", cex=1.4,
    main="weight int / all", xlab="council", ylab="")

plot(with(db, tapply(int_weight, area_cod, function(y) sum(y)/length(y))), type="h", cex=1.4,
    main="weight int / all", xlab="area", ylab="")

``


